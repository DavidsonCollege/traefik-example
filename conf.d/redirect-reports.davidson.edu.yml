# Parameters ##################################################################

{{ $domain := "reports.davidson.edu" }}
{{ $target := "https://data.davidson.edu/pbireports/browse" }}

# Template ####################################################################

http:
  {{ $name := $domain | replace "." "-" | printf "REDIRECT-%s" }}
  routers:
    {{ $name }}:
      rule: "Host(`{{ $domain }}`)"
      service: redirect
      middlewares:
      - {{ $name }}
      entrypoints:
      - websecure
  middlewares:
    {{ $name }}:
      redirectregex:
        replacement: "{{ $target }}"
        permanent: true 
        regex: "(.*)"


